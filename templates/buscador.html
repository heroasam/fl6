{% extends "base_template.html" %}

{% block title %}Clientes{% endblock %}
{% block style %}
<style>
 .articulos{
    background-color: lightyellow;
    color:black;
}
caption{
    caption-side: top;
}
</style>
{% endblock %}

{% block content %}
<div class="container">
<div id="app">
    <div class="buttons">
        <div v-for="historico in historial">
            <button class="button is-outlined is-primary" @click="buscaCuentaporDni(historico[0])">|historico[1].slice(0,18)|</button>
        </div>
    </div>
      <div class="columns">
          <div class="column is-8">
            <div class="field is-horizontal">
                <input type="search" placeholder="Buscar en Romitex" class="input" v-model="buscar" @keyup.enter="buscarCliente" @focus="buscar='';verCard=false" style="width: 400px;">
                <button type="button" @click="buscarCliente" class="button is-primary">Buscar</button>
              </div>
          </div>
      </div>

    <div class="buttons" v-if="buscar">
        <div v-for="cliente in clientes">
            <!-- [dni,nombre,direccion] -->
        <button class="button is-info" @mouseover="buscar=cliente[2]" @click="buscaCuentaporDni(cliente[0])">|cliente[1]|</button>
        </div>
    </div>
    <!-- card datos clientes -->
    <div class="box"  v-if="verCard">
        
            
                <p class="title is-2">|nombre|  |dni|</p>
                <p class="subtitle is-4">|calle+' '+num|  |barrio|  zona:|zona|</p>
                <p class="subtitle is-4">tel:|tel| wapp:|wapp|</p>
              
                <p class="" v-if="acla">|acla|</p>
                <p class="" v-if="mjecobr">|mjecobr|</p>
                <p class="" v-if="horario">|horario|</p>
                <p class="" v-if="infoseven">|infoseven|</p>
                <div class="buttons">
                    <button class="button is-danger " v-if="novendermas">|novendermas|</button>
                    <button class="button is-success " v-if="sev">|sev|</button>
                    <button class="button is-info " v-if="subirseven">|subirseven|</button>
                    <button class="button is-danger " v-if="mudo">|mudo|</button>
                    <button class="button is-warning " v-if="gestion">|gestion|</button>
                    <button class="button is-danger " v-if="incobrable">|incobrable|</button>
                    <button class="button is-info " v-if="seguir">|seguir|</button>
                    <button class="button is-dark " v-if="llamar">|llamar|</button>
                </div>
                    <span class="tag is-danger is-large" >PmoVto</span>
                    <input type="date" v-model="pmovto" class="input" style="width: 200px;">
                    <button class="button is-outlined is-success" @click="fecharPmoVto">Fechar</button>
                    <button class="button is-info ">Deuda $|deuda|</button>
                    <button type="button" class="button is-dark" data-toggle="modal" data-target="#staticBackdrop" @click="editarDatos">Editar</button>
                    
               
         
    </div>
    <!-- botonera funcional -->
    <div class="block" v-if="verCard">
        <button class="button is-outlined is-info is-small" @click="verVentas=!verVentas">Ver Ventas</button>
        
        <button class="button is-outlined is-warning is-small" @click="imprimirFicha">Impr Ficha</button>
        <a href="#" class="button is-outlined is-warning is-small">Intimar</a>
        <button class="button is-outlined is-success is-small" @click="cargarWapp">Wapp</button>
        <button class="button is-outlined is-success is-small" @click="cargarDatos">Datos</button>
        <button class="button is-outlined is-danger is-small" @click="toggleSube">SUBE</button>
        <button class="button is-outlined is-danger is-small"@click="toggleGestion">Gestion</button>
        <button class="button is-outlined is-danger is-small"@click="toggleMudado">Mudado</button>
        <button class="button is-outlined is-danger is-small"@click="toggleInc">INC</button>
        <button class="button is-outlined is-danger is-small"@click="toggleLN">LN</button>
        <button class="button is-outlined is-danger is-small"@click="toggleLlamar">Llamar</button>
        <button class="button is-outlined is-danger is-small"@click="toggleSeguir">Seguir</button>
        <input type="hidden" name="csrf_token" ref="token" value="{{ csrf_token() }}"/>
    </div>
    <!-- tabla ventas -->
    <div class="block" v-if="verCard">
        <table class="table table-sm">
            <thead >
                <tr @click="!verVentas">
                <th>Id</th>
                <th>fecha</th>
                <th>plan</th>
                <th>DEBE</th>
                <th>Compra</th>
                <th>vdor</th>
                <th>info</th>
                <th>cnt</th>
                <th>art</th>
                </tr>
            </thead>
            <tbody>
                <tr v-for="venta in ventas" v-if="venta[3]||verVentas">
                <td>|venta[0]|</td>
                <td>|venta[1]|</td>
                <td>|venta[2]|</td>
                <td>$|venta[3]|</td>
                <td>$|venta[4]|</td>
                <td>|venta[5]|</td>
                <td>
                    <button class="button is-danger is-small" v-if="venta[6]">|venta[6]|</button>
                    <button class="button is-success is-small" v-if="venta[7]">|venta[7]|</button>
                    <button class="button is-primary is-small" v-if="venta[8]">|venta[8]|</button>
                </td>
                <td>|venta[9]|</td>
                <td>|venta[10]|</td>
                </tr>
            </tbody>
        </table>
    </div>
    <!-- tabla cuotas a pagar -->
    <div class="columns is-mobile" v-if="verCard" >
        <div class="column is-3-desktop is-6-mobile">
            <table class="table table-sm"  style="width: 300px;" v-show="cuotas.length">
                <caption>Cuotas a pagar</caption>
                <thead>
                    <tr>
                        <th>Id</th>
                        <th>Fecha</th>
                        <th>Saldo</th>
                    </tr>
                </thead>
                <tbody>
                    <tr v-for="cuota in cuotas">
                        <td>|cuota[0]|</td>
                        <td>|cuota[1]|</td>
                        <td>$|cuota[2]|</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="column is-4-desktop is-6-mobile">
            <!-- tabla cuotas pagadas -->
        <table class="table table-sm ml-5"  style="min-width: 300px;" v-show="pagadas.length">
            <caption>Pagos Realizados</caption>
            <thead>
                <tr>
                    <th>Fecha</th>
                    <th>Rbo</th>
                    <th>Imp</th>
                    <th>Rec</th>
                    <th>Cobr</th>
                </tr>
            </thead>
            <tbody>
                <tr v-for="pagada in pagadas">
                    <td>|pagada[0]|</td>
                    <td>|pagada[1]|</td>
                    <td style="min-width: 100px;">$|pagada[2]|</td>
                    <td>$|pagada[3]|</td>
                    <td>|pagada[4]|</td>
                </tr>
            </tbody>
        </table>
        </div>
    </div>
    <!-- tabla comentarios -->
    <div class="block" v-if="verCard && comentarios.length">
        <table class="table table-sm">
            <thead>
                <tr>
                    <th>Fecha</th>
                    <th>Comentario</th>
                </tr>
            </thead>
            <tbody>
                <tr v-for="comentario in comentarios">
                    <td>|comentario[0]|</td>
                    <td>|comentario[1]|</td>
                </tr>
            </tbody>
        </table>
    </div>

  <!-- Modal Edicion de datos Clientes -->
  <div class="modal" :class="{'is-active':toggleModal}">
    <div class="modal-background"></div>
    <div class="modal-content">
        
         
            <form class="box" id="EditarForm">
                <input type="hidden" name="csrf_token" ref="token" value="{{ csrf_token() }}"/>
                <div class="columns">
                  <div class="column is-1">
                    <input type="text" v-model="sex" placeholder="Sexo" size="1" class="input" ref="sex" @keyup.enter="$refs.dni.focus()" @blur="validarSex">
                    <p v-show="!sex" class="help is-danger">Requerido</p>
                  </div>
                  <div class="column is-2">
                    <input type="text" v-model="dni" placeholder="DNI" size="6" class="input" ref="dni" @keyup.enter="$refs.nombre.focus()">
                    <p v-show="!dni" class="help is-danger">Requerido</p>
                  </div>
                  <div class="column is-5">
                    <input type="text" v-model="nombre" placeholder="Nombre" size="60" class="input" ref="nombre" @keyup.enter="$refs.tel.focus()">
                    <p v-show="!nombre" class="help is-danger">Requerido</p>
                  </div>
                  <div class="column is-2">
                    <input type="text" v-model="tel" placeholder="Telefono" size="20" class="input" ref="tel" @keyup.enter="$refs.wapp.focus()">
                  </div>
                  <div class="column is-2">
                    <input type="text" v-model="wapp" placeholder="WhatApp" size="20" class="input" ref="wapp" @keyup.enter="$refs.calle.focus()">
                  </div>
                </div>
                <div class="columns">
                  <div class="column is-4">
                      <b-autocomplete
                            ref="calle"
                            @keyup.enter.native="$refs.num.focus()"
                            v-model="calle"
                            :data="callesFiltradasArray"
                            placeholder="Calle"
                            clearable
                            keep-first
                            @select="option => selected = option">
                            <template #empty>No se encontraron resultados</template>
                        </b-autocomplete>
                      <p v-show="!calle" class="help is-danger">Requerido</p>
                  </div>
                  <div class="column is-1">
                    <input type="text" v-model="num" placeholder="Num" size="10" class="input" ref="num" @keyup.enter="$refs.barrio.focus()" >
                    <p v-show="!num" class="help is-danger">Requerido</p>
                  </div>
                  <div class="column is-4">
                  <b-autocomplete
                            ref="barrio"
                            @keyup.enter.native="$refs.zona.focus()"
                            v-model="barrio"
                            :data="barriosFiltradasArray"
                            placeholder="Barrio"
                            clearable
                            keep-first
                            @select="option => selected = option">
                            <template #empty>No se encontraron resultados</template>
                        </b-autocomplete>
                  <p v-show="!barrio" class="help is-danger">Requerido</p>
                  </div>
                  <div class="column is-3">
                  <b-autocomplete
                            ref="zona"
                            @keyup.enter.native="$refs.acla.focus()"
                            v-model="zona"
                            :data="zonasFiltradasArray"
                            placeholder="Zona"
                            clearable
                            keep-first
                            @select="option => selected = option">
                            <template #empty>No se encontraron resultados</template>
                        </b-autocomplete>
                  <p v-show="!zona" class="help is-danger">Requerido</p>
                  </div>
                </div>
                <div class="columns">
                  <div class="column is-3">
                    <input type="text" v-model="acla" placeholder="Aclaracion" size="30" class="input" ref="acla" @keyup.enter="$refs.horario.focus()">
                  </div>
                  <div class="column is-3">
                    <input type="text" v-model="horario" placeholder="Horario" size="30" class="input" ref="horario" @keyup.enter="$refs.mjecobr.focus()">
                  </div>
                  <div class="column is-3">
                    <input type="text" v-model="mjecobr" placeholder="Mje Cobrador" size="30" class="input" ref="mjecobr" @keyup.enter="$refs.infoseven.focus()">
                  </div>
                  <div class="column is-3">
                    <input type="text" v-model="infoseven" placeholder="InfoSeven" size="30" class="input" ref="infoseven" @keyup.enter="$refs.guardarcliente.focus()">
                  </div>
                </div>
                <div class="columns">
                  <div class="column is-1" >
                    <button type="button" class="button is-danger" ref="guardarcliente" @click="validarCliente" @keyup.space="$refs.fecha.focus()">Guardar</button>
                  </div>
                </div>
              </form>

       
    </div>
    <button class="modal-close is-large" aria-label="close" @click="modal"></button>
   
    </div>


</div>
</div>
{% endblock %}
{% block script %}
<script>
function textToClipboard (text) {
    var dummy = document.createElement("textarea");
    document.body.appendChild(dummy);
    dummy.value = text;
    dummy.select();
    document.execCommand("copy");
    document.body.removeChild(dummy);
}

const app = new Vue({
    el:"#app",
    delimiters:['|','|'],
    data:{
        verCard:false,
        buscar:'',
        clientes: [],
        id:'',
        sex:'',
        dni:'',
        nombre:'',
        calle:'',
        num:'',
        direccion:'',
        barrio:'',
        tel:'',
        wapp:'',
        zona:'',
        acla:'',
        horario:'',
        mjecobr:'',
        infoseven:'',
        pmovto:'',
        deuda:'',
        sev:'',
        incobrable:'',
        mudo:'',
        llamar:'',
        gestion:'',
        subirseven:'',
        novendermas:'',
        seguir:'',
        ventas:[],
        verVentas:false,
        articulos:[],
        cuotas:[],
        pagadas:[],
        historial:[],
        calles:[],
        barrios:[],
        zonas:[],
        comentarios:[],
        darkmode:'', 
        arrayVentas:[],   
        toggleModal: false,
        selected: null,

    },
    methods: {
        buscarCliente(){
            axios.get('/buscador/'+this.buscar)
            .then(res=>{
                this.clientes = res.data.clientes
                if(this.clientes.length==1) this.buscaCuentaporDni(this.clientes[0][0])
            })
            .catch(error=>{
                bulmaToast.toast({
                    message:error.request.response,
                    type: "is-danger"
                })
            })
        },
        buscaCuentaporDni(dni){
            axios.get('/buscador/'+dni)
            .then(res=>{
                /* dni[0],nombre[1],calle[2],num[3],barrio[4],tel[5],wapp[6],zona[7],pmovto[8],deuda[9]
                ,sev[10],incobrable[11],gestion[12],subirseven[13],novendermas[14],seguir[15],
                mudo[16],llamar[17],acla[18],horario[19],mjecobr[20],infoseven[21],sex[22],id[23] */
                this.clientes = res.data.clientes
                this.dni = this.clientes[0][0]
                this.nombre = this.clientes[0][1]
                this.calle = this.clientes[0][2]
                this.num = this.clientes[0][3]
                this.direccion = this.calle+' '+this.num
                this.barrio = this.clientes[0][4]
                this.tel = this.clientes[0][5]
                this.wapp = this.clientes[0][6]
                this.zona = this.clientes[0][7]
                this.pmovto = dayjs.utc(this.clientes[0][8]).format('YYYY-MM-DD')
                this.deuda = this.clientes[0][9]
                this.sev = this.clientes[0][10]==1?'Seven':null
                this.incobrable = this.clientes[0][11]==1?'INCOBRABLE':null
                this.gestion = this.clientes[0][12]==1?'Gestion':null
                this.subirseven = this.clientes[0][13]==1?'SUBE':null
                this.novendermas = this.clientes[0][14]==1?'NV+':null
                this.seguir = this.clientes[0][15]==1?'Seguir':null
                this.mudo = this.clientes[0][16]==1?'MUDO':null
                this.llamar = this.clientes[0][17]==1?'Llamar':null
                this.acla = this.clientes[0][18]
                this.horario = this.clientes[0][19]
                this.mjecobr = this.clientes[0][20]
                this.infoseven = this.clientes[0][21]
                this.sex = this.clientes[0][22]
                this.id = this.clientes[0][23]

                this.verCard = true;
                this.buscar = '';
                this.clientes = [];
                this.pedirVentas(this.id)
                this.pedirComentarios(this.id)

                //botones de historial
                let agregar=true;
                this.historial.forEach(row=>{
                    if(row[1]==this.nombre) agregar=false
                })
                if(this.historial.length>3 && agregar) {
                    this.historial.unshift([this.dni,this.nombre])
                    this.historial.pop()
                }
                if(this.historial.length<=3 && agregar) {
                    this.historial.unshift([this.dni,this.nombre])
                }
            })
            .catch(error=>{
                bulmaToast.toast({
                    message:error.request.response,
                    type: "is-danger"
                })
            })

        },
        pedirVentas(id){
            axios.get('/buscador/pedirventas/'+id)
            .then(res=>{
                //console.log(res.data.ventas);
                this.arrayVentas = Array.from(res.data.ventas)
                let arrayTblVtas = []
                this.arrayVentas.forEach(vta=>{
                    /* id,fecha,cc,ic,p,idvdor,saldo,comprado,pp,pcc,pic,pper,devuelta,condonada,cnt,art,pagado,primera */
                    let array = []
                    array.push(vta[0])
                    array.push(dayjs.utc(vta[1]).format('YYYY-MM-DD'))
                    if(vta[8]==0){
                        array.push(`${vta[2]} cuotas ${vta[4]==1?'MEN':'SEM'} de $${vta[3]}`)
                    }else{
                        array.push(`${vta[9]} cuotas ${vta[11]==1?'MEN':'SEM'} de $${vta[10]}`)
                    }
                    array.push(vta[6])
                    array.push(vta[7])
                    array.push(vta[5])
                    array.push(vta[8]==1?'PLAN DE PAGO':null)
                    array.push(vta[12]==1?'DEVUELTA':null)
                    array.push(vta[13]==1?'CONDONADA':null)
                    array.push(vta[14])
                    array.push(vta[15])
                    arrayTblVtas.push(array)
                })
                console.log(this.arrayVentas);
                this.ventas=arrayTblVtas;
                this.cuotas = this.hacerCuotas()
                this.pedirPagadas(this.id)
            })
        },
        pedirComentarios(id){
            axios.get('/buscador/pedircomentarios/'+id)
            .then(res=>{
                //console.log(res.data.comentarios);
                arrayComentarios = Array.from(res.data.comentarios)
                arrayComentarios.forEach(row=>{
                    row[0]=dayjs.utc(row[0]).format('YYYY-MM-DD')
                })
                this.comentarios=arrayComentarios
            })
        },
        hacerCuotas(){
            /* id,fecha,cc,ic,p,idvdor,saldo,comprado,pp,pcc,pic,pper,devuelta,condonada,cnt,art,pagado,primera,pprimera,ppagado */
            tblCuota=[]
            let vto
            this.arrayVentas.forEach(row=>{
                saldo = row[6]
                pp = row[8]
                if(pp===0){
                    if(saldo!==0){
                        pagado = row[16]
                        cc = row[2]
                        ic = row[3]
                        p = row[4]
                        primera = row[17]
                        for (let i=1; i<=cc ;i++){
                            if(p===1) vto = dayjs.utc(primera).add(i-1,'month').format('YYYY-MM-DD')
                            if(p===2) vto = dayjs.utc(primera).add((i-1)*2,'week').format('YYYY-MM-DD')
                            if(p===3) vto = dayjs.utc(primera).add(i-1,'week').format('YYYY-MM-DD')
                            tblCuota.push([i,vto,pagado>=ic?0:pagado<=0?ic:ic-pagado])
                            pagado = pagado - ic
                        }
                    }
                }else{
                    if(saldo!==0){
                        pagado = row[19]
                        cc = row[9]
                        ic = row[10]
                        p = row[11]
                        primera = row[18]
                        for (let i=1; i<=cc ;i++){
                            if(p===1) vto = dayjs.utc(primera).add(i-1,'month').format('YYYY-MM-DD')
                            if(p===2) vto = dayjs.utc(primera).add((i-1)*2,'week').format('YYYY-MM-DD')
                            if(p===3) vto = dayjs.utc(primera).add(i-1,'week').format('YYYY-MM-DD')
                            tblCuota.push([i,vto,pagado>=ic?0:pagado<=0?ic:ic-pagado])
                            pagado = pagado - ic
                        }
                    }
                }
            })
            return tblCuota
        },
        pedirPagadas(id){
            axios.get('/buscador/pedirpagadas/'+id)
            .then(res=>{
                this.pagadas = res.data.pagadas
                this.pagadas.map(row=>row[0]=dayjs.utc(row[0]).format('YYYY-MM-DD'))
            })
        },
        fecharPmoVto(){
            axios.get('/buscador/fecharpmovto/'+this.dni+'/'+this.pmovto)
            .then(res=>{
                //console.log(res);
              bulmaToast.toast({
                  message:"PmoVto establecido",
                  type: "is-success"
              })
            })
        },
        cargarWapp(){
            let text,
                messaje;
            axios.get('/buscador/datosultvta/'+this.dni)
            .then(res=>{
                let fecha = res.data.ultvta[0][0];
                let articulos = res.data.ultvta[0][1];
                if (this.sev=='Seven'){
                text=
                `Nos comunicamos de la empresa ROMITEX por una deuda que usted tiene con la firma. Usted fue subido al SEVEN hasta regularizar su cuenta. Puede hacer un plan de pagos. Consulte por Wapp. Una vez cancelado en 24hs se lo elimina del SEVEN. De no desmostrar interes nos vemos obligados a cobrar su pagare por via JUDICIAL. Atte. *Departamento de cobranzas de ROMITEX*`
                } else {
                    text=
                    `Nos comunicamos de la empresa ROMITEX por una deuda que usted tiene con la firma. En los proximos dias deberemos informar al SEVEN el atraso de su cuenta. Le proponemos un plan de pagos que podemos realizar por este medio.`
                }
                messaje = this.nombre.concat(': ',text,' ',`(Por compra de ${articulos} realizada en '${this.direccion}' el dia ${dayjs.utc(fecha).format('DD-MM-YYYY')})`)
                //console.log(messaje);
                textToClipboard(messaje)
                bulmaToast.toast({
                    message: "Notificacion copiada al portapapeles",
                    type: "is-success"
                })
            })
        },
        cargarDatos(){
            let text = this.dni+'\n'+this.direccion+'\n'+this.barrio+'\n'+this.wapp
            textToClipboard(text)
            bulmaToast.toast({
                    message: "Datos copiados al portapapeles",
                    type: "is-success"
                })
        },
        toggleSube(){
            axios.get('/buscador/togglesube/'+this.dni)
            .then(res=>{
                this.buscaCuentaporDni(this.dni)
            })
        },
        toggleGestion(){
            axios.get('/buscador/togglegestion/'+this.dni)
            .then(res=>{
                this.buscaCuentaporDni(this.dni)
            })
        },
        toggleMudado(){
            axios.get('/buscador/togglemudado/'+this.dni)
            .then(res=>{
                this.buscaCuentaporDni(this.dni)
            })
        },
        toggleInc(){
            axios.get('/buscador/toggleinc/'+this.dni)
            .then(res=>{
                this.buscaCuentaporDni(this.dni)
            })
        },
        toggleLN(){
            axios.get('/buscador/toggleln/'+this.dni)
            .then(res=>{
                this.buscaCuentaporDni(this.dni)
            })
        },
        toggleLlamar(){
            axios.get('/buscador/togglellamar/'+this.dni)
            .then(res=>{
                this.buscaCuentaporDni(this.dni)
            })
        },
        toggleSeguir(){
            axios.get('/buscador/toggleseguir/'+this.dni)
            .then(res=>{
                this.buscaCuentaporDni(this.dni)
            })
        },
        editarDatos(){
            this.modal()
        },
        getTablas(){
            axios.get('/buscador/gettablas')
            .then(res=>{
                //console.log(res.data.calles);
                this.calles=res.data.calles
                this.barrios=res.data.barrios
                this.zonas=res.data.zonas
            })
        },
        imprimirFicha(){
            let ids = [];
            ids.push(this.dni);
            axios.defaults.headers.common['X-CSRF-TOKEN'] = this.$refs.token.value
            axios({
                method:"POST",
                url:"/buscador/imprimirficha",
                responseType: "blob",
                data: ids,
            }).then((res)=>{
                let url = window.URL.createObjectURL(res.data);
                window.open(url);
            })

        },
        validarSex(){
            if(this.sex==''){
            bulmaToast.toast({message:"este campo es requerido", type:'is-danger'})
            this.$refs.sex.focus()
            }
            if(this.sex!='f'&&this.sex!='F'&&this.sex!='m'&&this.sex!='M'){
            bulmaToast.toast({message:"unicamente se aceptan F o M", type:'is-danger'})
            this.$refs.sex.focus()
            }
            this.sex = this.sex.toUpperCase()
        },
        validarCliente(){
            if(this.sex!=''&&this.dni!=''&&this.nombre!=''&&this.calle!=''&&this.num!=''&&this.barrio!=''&&this.zona!=''){
            this.guardarCliente()
            }else{
            bulmaToast.toast({message:"Complete los datos minimos requeridos", type:'is-danger'})
            }
        },
        guardarCliente(){
            axios.defaults.headers.common['X-CSRF-TOKEN'] = this.$refs.token.value
            axios({
                method:'POST',
                url:'/ventas/guardarcliente',
                data:{
                    id:this.id,
                    sex:this.sex,
                    dni:this.dni,
                    nombre:this.nombre,
                    calle:this.calle,
                    num:this.num,
                    barrio:this.barrio,
                    zona:this.zona,
                    acla:this.acla,
                    horario:this.horario,
                    mjecobr:this.mjecobr,
                    infoseven:this.infoseven,
                    tel:this.tel,
                    wapp:this.wapp,
                }
                })
                .then(res=>{
                  bulmaToast.toast({message:"Cliente editado con exito", type:'is-success'})
                  this.modal()
                })
                .catch(error=>{
                  bulmaToast.toast({message:error.request.response, type:'is-danger'})
                })
      },
        modal(){
          this.toggleModal=!this.toggleModal
        },
    },
    computed: {
        callesFiltradasArray() {
            return this.calles.filter((option) => {
                return option
                    .toString()
                    .toLowerCase()
                    .indexOf(this.calle.toLowerCase()) >= 0
            })
        },
        barriosFiltradasArray() {
            return this.barrios.filter((option) => {
                return option
                    .toString()
                    .toLowerCase()
                    .indexOf(this.barrio.toLowerCase()) >= 0
            })
        },
        zonasFiltradasArray() {
            return this.zonas.filter((option) => {
                return option
                    .toString()
                    .toLowerCase()
                    .indexOf(this.zona.toLowerCase()) >= 0
            })
        },
    },
    created: function(){
        this.getTablas();
    },

})

</script>
{% endblock %}
