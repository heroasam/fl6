{% extends "base.html" %}

{% block title %}Ventas por dia{% endblock %}
{% block style %}
<style>
</style>
{% endblock %}

{% block content %}

<div class="container">

  <p class="title is-1">Ventas por Dia</p>

  {{tbl|safe}}

</div>
{% endblock %}

{% block script %}
<script>
 let tableId = document.getElementById('tableventas')
 let tbody = tableId.querySelector('tbody');
 let thead = tableId.querySelector('thead');
 let tr = thead.children[0]
 let ths = tr.children
 for(i=1; i<ths.length;i++){
     ths[i].classList.add('numeric')
 }
 ths[3].innerText = 'Total'
 let rowsArray = Array.from(tbody.rows);
 let rowIndex=[];
 rowsArray.forEach((row)=>{
     rowIndex.push(row.rowIndex-1)
     for(let i=1; i<row.children.length;i++){
         row.cells[i].classList.add('pesos')
     }
 });
 let maxRow = Math.max(...rowIndex)+1;
 let $rowTotal = tbody.insertRow(maxRow);
 let $cell0 = $rowTotal.insertCell(0);
 $cell0.innerHTML = "Total";
 $rowTotal.classList.add('total');

 const cols = rowsArray[0].children.length // determino la cant columnas
 for(let i=1;i<cols;i++){
     let col = [];
     rowIndex.forEach((ix)=>{
         col.push(nop(tbody.rows[ix].cells[i].innerText))
     });
     let total = col.reduce((a,b)=>Number(a)+Number(b));
     let $cell = $rowTotal.insertCell(i);
     if (!(Number.isNaN(total))) $cell.innerHTML = total
     $cell.classList.add('pesos')
 }

</script>
{% endblock %}
