{% extends "base.html" %}

{% block title %}Estimados{% endblock %}
{% block style %}
<style>
</style>
{% endblock %}

{% block content %}

<div class="container" x-data="main()" x-init="getGrafico()">

  <div class="buttons">
    <a href="/pagos" class="button is-primary">Pagos</a>
    <a href="/pagos/verplanillas" class="button is-primary">Planillas</a>
    <a href="/loterbo" class="button is-primary">Registrar Lote Rbos</a>
    <a href="/loterbo/ver" class="button is-primary">Ver Lote Rbos</a>
    <a href="/pagos/editarrbo" class="button is-primary">Editar Rbo</a>
    <a href="/pagos/verzona" class="button is-primary">Ver Zona</a>
    <a href="/pagos/cobrostotales" class="button is-primary">Totales</a>
    <a href="/pagos/comisiones" class="button is-primary">Comisiones</a>
    <a href="/pagos/altas" class="button is-primary">Altas</a>
    <a href="/pagos/bajas" class="button is-primary">Bajas</a>
  </div>

  <p class="title is-1">Estimados a Cobrar</p>

  {{tbl|safe}}
  <div class="block">
    <canvas id="grafico-estadistica" width="400" height="200"></canvas>
  </div>
  <p class="subtitle is-3">Estimados por Zona</p>
  {{tbl1|safe}}
</div>
{% endblock %}

{% block script %}
<script>
 function main(){
     return{
	     mescobranza:[],
	     cobranzatotal:[],
	     getGrafico(){
             this.mescobranza = {{index|tojson}}
             this.cobranzatotal = totalizar_tabla('estimados',1)

             const canvas = document.getElementById('grafico-estadistica').getContext('2d');
             const chart = new Chart(canvas, {
		         type: 'bar',
		         data: {
                     labels: this.mescobranza,
                     datasets: [{
			             label: 'Estimados a Cobrar',
			             data: this.cobranzatotal,
			             order: 1,
			             backgroundColor: [
                             'rgba(255, 99, 132, 0.2)',
                             'rgba(54, 162, 235, 0.2)',
                             'rgba(255, 206, 86, 0.2)',
                             'rgba(75, 192, 192, 0.2)',
                             'rgba(153, 102, 255, 0.2)',
                             'rgba(255, 159, 64, 0.2)'
			             ],
			             borderColor: [
                             'rgba(255, 99, 132, 1)',
                             'rgba(54, 162, 235, 1)',
                             'rgba(255, 206, 86, 1)',
                             'rgba(75, 192, 192, 1)',
                             'rgba(153, 102, 255, 1)',
                             'rgba(255, 159, 64, 1)'
			             ],
			             borderWidth: 1
                     },
		             ]
		         },
		         options: {
                     scales: {
			             y: {
                             beginAtZero: true
			             }
                     }
		         }
             });
	     },
 }}
</script>
{% endblock %}
